{"ast":null,"code":"import snoowrap from 'snoowrap';\nimport axios from 'axios';\n\n// Reddit API credentials\nconst CLIENT_ID = 'WmNlQp2tb3gJEHShUxhabw';\nconst CLIENT_SECRET = 'FO5usm5pNweGlj1PWgT57x8DQkuG9A';\nconst REDIRECT_URI = 'http://localhost:3000/auth-callback';\nconst RANDOM_STRING = 'random_string'; // Should be generated per session\nconst SCOPES = ['history', 'identity'];\nexport const getAuthUrl = () => {\n  return `https://www.reddit.com/api/v1/authorize?client_id=${CLIENT_ID}&response_type=code&state=${RANDOM_STRING}&redirect_uri=${REDIRECT_URI}&duration=temporary&scope=${SCOPES.join(' ')}`;\n};\nexport const getAccessToken = async code => {\n  try {\n    const response = await axios.post('https://www.reddit.com/api/v1/access_token', `grant_type=authorization_code&code=${code}&redirect_uri=${REDIRECT_URI}`, {\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded'\n      },\n      auth: {\n        username: CLIENT_ID,\n        password: CLIENT_SECRET // Client secret is not needed for installed apps\n      }\n    });\n    return response.data.access_token;\n  } catch (error) {\n    console.error('Error getting access token:', error);\n    throw error;\n  }\n};\nexport const createRedditClient = accessToken => {\n  return new snoowrap({\n    userAgent: 'web:reddit-saved-gallery:v1.0 (by /u/YOUR_USERNAME)',\n    accessToken\n  });\n};\nexport const getSavedPosts = async redditClient => {\n  try {\n    const savedItems = await redditClient.getMe().getSavedContent();\n    // Filter for posts with media\n    return savedItems.filter(post => {\n      // Check if it's a submission (not a comment)\n      if (!post.title) return false;\n\n      // Check for various media types\n      return post.is_video || post.post_hint === 'image' || post.url.match(/\\.(jpg|jpeg|png|gif)$/) || post.url.includes('imgur.com') || post.url.includes('gfycat.com') || post.url.includes('redgifs.com') || post.url.includes('i.redd.it');\n    });\n  } catch (error) {\n    console.error('Error fetching saved posts:', error);\n    throw error;\n  }\n};\nexport const getMediaUrl = post => {\n  // Handle direct image links\n  if (post.url.match(/\\.(jpg|jpeg|png|gif)$/i)) {\n    return post.url;\n  }\n\n  // Handle Reddit videos\n  if (post.is_video && post.media && post.media.reddit_video) {\n    return post.media.reddit_video.fallback_url;\n  }\n\n  // Handle imgur links without extension\n  if (post.url.includes('imgur.com') && !post.url.match(/\\.(jpg|jpeg|png|gif)$/i)) {\n    return `${post.url}.jpg`;\n  }\n\n  // Handle gfycat links\n  if (post.url.includes('gfycat.com')) {\n    const gfycatId = post.url.split('/').pop();\n    return `https://thumbs.gfycat.com/${gfycatId}-size_restricted.gif`;\n  }\n\n  // Default case\n  return post.thumbnail !== 'default' ? post.thumbnail : null;\n};","map":{"version":3,"names":["snoowrap","axios","CLIENT_ID","CLIENT_SECRET","REDIRECT_URI","RANDOM_STRING","SCOPES","getAuthUrl","join","getAccessToken","code","response","post","headers","auth","username","password","data","access_token","error","console","createRedditClient","accessToken","userAgent","getSavedPosts","redditClient","savedItems","getMe","getSavedContent","filter","title","is_video","post_hint","url","match","includes","getMediaUrl","media","reddit_video","fallback_url","gfycatId","split","pop","thumbnail"],"sources":["/Users/zachary/Desktop/reddit-saved-gallery/src/services/redditApi.js"],"sourcesContent":["import snoowrap from 'snoowrap';\nimport axios from 'axios';\n\n// Reddit API credentials\nconst CLIENT_ID = 'WmNlQp2tb3gJEHShUxhabw';\nconst CLIENT_SECRET = 'FO5usm5pNweGlj1PWgT57x8DQkuG9A'\nconst REDIRECT_URI = 'http://localhost:3000/auth-callback';\nconst RANDOM_STRING = 'random_string'; // Should be generated per session\nconst SCOPES = ['history', 'identity'];\n\nexport const getAuthUrl = () => {\n  return `https://www.reddit.com/api/v1/authorize?client_id=${CLIENT_ID}&response_type=code&state=${RANDOM_STRING}&redirect_uri=${REDIRECT_URI}&duration=temporary&scope=${SCOPES.join(' ')}`;\n};\n\nexport const getAccessToken = async (code) => {\n  try {\n    const response = await axios.post(\n      'https://www.reddit.com/api/v1/access_token',\n      `grant_type=authorization_code&code=${code}&redirect_uri=${REDIRECT_URI}`,\n      {\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded',\n        },\n        auth: {\n          username: CLIENT_ID,\n          password: CLIENT_SECRET, // Client secret is not needed for installed apps\n        },\n      }\n    );\n    return response.data.access_token;\n  } catch (error) {\n    console.error('Error getting access token:', error);\n    throw error;\n  }\n};\n\nexport const createRedditClient = (accessToken) => {\n  return new snoowrap({\n    userAgent: 'web:reddit-saved-gallery:v1.0 (by /u/YOUR_USERNAME)',\n    accessToken,\n  });\n};\n\nexport const getSavedPosts = async (redditClient) => {\n  try {\n    const savedItems = await redditClient.getMe().getSavedContent();\n    // Filter for posts with media\n    return savedItems.filter(post => {\n      // Check if it's a submission (not a comment)\n      if (!post.title) return false;\n      \n      // Check for various media types\n      return (\n        post.is_video ||\n        post.post_hint === 'image' ||\n        post.url.match(/\\.(jpg|jpeg|png|gif)$/) ||\n        post.url.includes('imgur.com') ||\n        post.url.includes('gfycat.com') ||\n        post.url.includes('redgifs.com') ||\n        post.url.includes('i.redd.it')\n      );\n    });\n  } catch (error) {\n    console.error('Error fetching saved posts:', error);\n    throw error;\n  }\n};\n\nexport const getMediaUrl = (post) => {\n  // Handle direct image links\n  if (post.url.match(/\\.(jpg|jpeg|png|gif)$/i)) {\n    return post.url;\n  }\n  \n  // Handle Reddit videos\n  if (post.is_video && post.media && post.media.reddit_video) {\n    return post.media.reddit_video.fallback_url;\n  }\n  \n  // Handle imgur links without extension\n  if (post.url.includes('imgur.com') && !post.url.match(/\\.(jpg|jpeg|png|gif)$/i)) {\n    return `${post.url}.jpg`;\n  }\n  \n  // Handle gfycat links\n  if (post.url.includes('gfycat.com')) {\n    const gfycatId = post.url.split('/').pop();\n    return `https://thumbs.gfycat.com/${gfycatId}-size_restricted.gif`;\n  }\n  \n  // Default case\n  return post.thumbnail !== 'default' ? post.thumbnail : null;\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}