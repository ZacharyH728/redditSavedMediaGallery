{"ast":null,"code":"\"use strict\";\n\nvar _Promise = _interopRequireDefault(require(\"./Promise.js\"));\nvar _url = _interopRequireDefault(require(\"url\"));\nvar _querystring = require(\"querystring\");\nvar _errors = require(\"./errors.js\");\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\n/* eslint-env browser */\n// Provide a shim for some of the functionality of the `request-promise` npm package in browsers.\n// Previously, snoowrap depended on browserify to package `request-promise` for the browser bundle, and while this worked\n// properly, it caused the snoowrap bundle to be very large since `request-promise` contains many dependencies that snoowrap\n// doesn't actually need.\nfunction noop() {}\nfunction tryParseJson(maybeJson) {\n  try {\n    return JSON.parse(maybeJson);\n  } catch (e) {\n    return maybeJson;\n  }\n}\nfunction parseHeaders(headerString) {\n  return headerString.split('\\r\\n').filter(function (line) {\n    return line;\n  }).reduce(function (accumulator, line) {\n    var index = line.indexOf(': ');\n    accumulator[line.slice(0, index)] = line.slice(index + 2);\n    return accumulator;\n  }, {});\n}\nmodule.exports = function rawRequest(options) {\n  // It would be nice to be able to use the `URL` API in browsers, but Safari 9 doesn't support `URLSearchParams`.\n  var parsedUrl = _url.default.parse(options.url || _url.default.resolve(options.baseUrl, options.uri), true);\n  parsedUrl.search = (0, _querystring.stringify)(Object.assign({}, parsedUrl.query, options.qs)); // create a new url object with the new qs params, to ensure that the `href` value changes (to use later for parsing response)\n\n  var finalUrl = _url.default.parse(parsedUrl.format());\n  var xhr = new XMLHttpRequest();\n  var method = options.method ? options.method.toUpperCase() : 'GET';\n  xhr.open(method, finalUrl.href);\n  Object.keys(options.headers).filter(function (header) {\n    return header.toLowerCase() !== 'user-agent';\n  }).forEach(function (key) {\n    return xhr.setRequestHeader(key, options.headers[key]);\n  });\n  if (options.auth) {\n    xhr.setRequestHeader('Authorization', options.auth.bearer ? \"bearer \".concat(options.auth.bearer) : 'basic ' + btoa(\"\".concat(options.auth.user, \":\").concat(options.auth.pass)));\n  }\n  var requestBody;\n  if (options.formData) {\n    requestBody = new FormData();\n    Object.keys(options.formData).forEach(function (key) {\n      return requestBody.append(key, options.formData[key]);\n    });\n    if (options.form) {\n      Object.keys(options.form).forEach(function (key) {\n        return requestBody.append(key, options.form[key]);\n      });\n    }\n    xhr.setRequestHeader('Content-Type', 'multipart/form-data');\n  } else if (options.form) {\n    requestBody = (0, _querystring.stringify)(options.form);\n    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\n  } else if (options.json) {\n    requestBody = JSON.stringify(options.body);\n    xhr.setRequestHeader('Content-Type', 'application/json');\n  } else {\n    requestBody = options.body;\n  }\n  return new _Promise.default(function (resolve, reject, onCancel) {\n    onCancel(function () {\n      return xhr.abort();\n    });\n    xhr.onload = function () {\n      var _this = this;\n      var success = this.status >= 200 && this.status < 300;\n      var settleFunc = success ? resolve : function (err) {\n        return reject(Object.assign(new _errors.StatusCodeError(_this.status + ''), err));\n      };\n      var response = {\n        statusCode: this.status,\n        body: (options.json ? tryParseJson : noop)(xhr.response),\n        headers: parseHeaders(xhr.getAllResponseHeaders()),\n        request: {\n          method,\n          uri: finalUrl\n        }\n      };\n      if (typeof options.transform === 'function') {\n        settleFunc(options.transform(response.body, response));\n      } else if (!success || options.resolveWithFullResponse) {\n        settleFunc(response);\n      } else {\n        settleFunc(response.body);\n      }\n    };\n    xhr.onerror = function (err) {\n      return reject(Object.assign(new _errors.RequestError(), err));\n    };\n    xhr.send(requestBody);\n  }).timeout(options.timeout || Math.pow(2, 31) - 1, 'Error: ETIMEDOUT').catch(_Promise.default.TimeoutError, function (err) {\n    xhr.abort();\n    throw err;\n  });\n};","map":{"version":3,"names":["_Promise","_interopRequireDefault","require","_url","_querystring","_errors","obj","__esModule","default","noop","tryParseJson","maybeJson","JSON","parse","e","parseHeaders","headerString","split","filter","line","reduce","accumulator","index","indexOf","slice","module","exports","rawRequest","options","parsedUrl","url","resolve","baseUrl","uri","search","stringify","Object","assign","query","qs","finalUrl","format","xhr","XMLHttpRequest","method","toUpperCase","open","href","keys","headers","header","toLowerCase","forEach","key","setRequestHeader","auth","bearer","concat","btoa","user","pass","requestBody","formData","FormData","append","form","json","body","reject","onCancel","abort","onload","_this","success","status","settleFunc","err","StatusCodeError","response","statusCode","getAllResponseHeaders","request","transform","resolveWithFullResponse","onerror","RequestError","send","timeout","Math","pow","catch","TimeoutError"],"sources":["/Users/zachary/Desktop/reddit-saved-gallery/node_modules/snoowrap/dist/xhr.js"],"sourcesContent":["\"use strict\";\n\nvar _Promise = _interopRequireDefault(require(\"./Promise.js\"));\n\nvar _url = _interopRequireDefault(require(\"url\"));\n\nvar _querystring = require(\"querystring\");\n\nvar _errors = require(\"./errors.js\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/* eslint-env browser */\n// Provide a shim for some of the functionality of the `request-promise` npm package in browsers.\n// Previously, snoowrap depended on browserify to package `request-promise` for the browser bundle, and while this worked\n// properly, it caused the snoowrap bundle to be very large since `request-promise` contains many dependencies that snoowrap\n// doesn't actually need.\nfunction noop() {}\n\nfunction tryParseJson(maybeJson) {\n  try {\n    return JSON.parse(maybeJson);\n  } catch (e) {\n    return maybeJson;\n  }\n}\n\nfunction parseHeaders(headerString) {\n  return headerString.split('\\r\\n').filter(function (line) {\n    return line;\n  }).reduce(function (accumulator, line) {\n    var index = line.indexOf(': ');\n    accumulator[line.slice(0, index)] = line.slice(index + 2);\n    return accumulator;\n  }, {});\n}\n\nmodule.exports = function rawRequest(options) {\n  // It would be nice to be able to use the `URL` API in browsers, but Safari 9 doesn't support `URLSearchParams`.\n  var parsedUrl = _url.default.parse(options.url || _url.default.resolve(options.baseUrl, options.uri), true);\n\n  parsedUrl.search = (0, _querystring.stringify)(Object.assign({}, parsedUrl.query, options.qs)); // create a new url object with the new qs params, to ensure that the `href` value changes (to use later for parsing response)\n\n  var finalUrl = _url.default.parse(parsedUrl.format());\n\n  var xhr = new XMLHttpRequest();\n  var method = options.method ? options.method.toUpperCase() : 'GET';\n  xhr.open(method, finalUrl.href);\n  Object.keys(options.headers).filter(function (header) {\n    return header.toLowerCase() !== 'user-agent';\n  }).forEach(function (key) {\n    return xhr.setRequestHeader(key, options.headers[key]);\n  });\n\n  if (options.auth) {\n    xhr.setRequestHeader('Authorization', options.auth.bearer ? \"bearer \".concat(options.auth.bearer) : 'basic ' + btoa(\"\".concat(options.auth.user, \":\").concat(options.auth.pass)));\n  }\n\n  var requestBody;\n\n  if (options.formData) {\n    requestBody = new FormData();\n    Object.keys(options.formData).forEach(function (key) {\n      return requestBody.append(key, options.formData[key]);\n    });\n\n    if (options.form) {\n      Object.keys(options.form).forEach(function (key) {\n        return requestBody.append(key, options.form[key]);\n      });\n    }\n\n    xhr.setRequestHeader('Content-Type', 'multipart/form-data');\n  } else if (options.form) {\n    requestBody = (0, _querystring.stringify)(options.form);\n    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\n  } else if (options.json) {\n    requestBody = JSON.stringify(options.body);\n    xhr.setRequestHeader('Content-Type', 'application/json');\n  } else {\n    requestBody = options.body;\n  }\n\n  return new _Promise.default(function (resolve, reject, onCancel) {\n    onCancel(function () {\n      return xhr.abort();\n    });\n\n    xhr.onload = function () {\n      var _this = this;\n\n      var success = this.status >= 200 && this.status < 300;\n      var settleFunc = success ? resolve : function (err) {\n        return reject(Object.assign(new _errors.StatusCodeError(_this.status + ''), err));\n      };\n      var response = {\n        statusCode: this.status,\n        body: (options.json ? tryParseJson : noop)(xhr.response),\n        headers: parseHeaders(xhr.getAllResponseHeaders()),\n        request: {\n          method,\n          uri: finalUrl\n        }\n      };\n\n      if (typeof options.transform === 'function') {\n        settleFunc(options.transform(response.body, response));\n      } else if (!success || options.resolveWithFullResponse) {\n        settleFunc(response);\n      } else {\n        settleFunc(response.body);\n      }\n    };\n\n    xhr.onerror = function (err) {\n      return reject(Object.assign(new _errors.RequestError(), err));\n    };\n\n    xhr.send(requestBody);\n  }).timeout(options.timeout || Math.pow(2, 31) - 1, 'Error: ETIMEDOUT').catch(_Promise.default.TimeoutError, function (err) {\n    xhr.abort();\n    throw err;\n  });\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}